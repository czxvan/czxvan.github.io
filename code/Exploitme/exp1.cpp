#include <cstdio>

_declspec(noinline) int old_main() {
    char name[32];
    printf("Reading name from file...\n");

    FILE* f = fopen("D:\\Users\\czx\\NativeFiles\\Desktop\\tmp\\name.dat", "rb");
        if (!f)
            return -1;
    fseek(f, 0L, SEEK_END);
    long bytes = ftell(f);
    fseek(f, 0L, SEEK_SET);
    int pos = 0;
    while (pos < bytes) {
        int len = bytes - pos > 200 ? 200 : bytes - pos;
        fread(name + pos, 1, len, f);
        pos += len;
    }

    *(name+bytes) = '\0'; // 这种写法可以免去数组边界检查，下文对此有分析
    // name[bytes] = '\0';

    fclose(f);
    printf("Hi, %s!\n", name);
    return 0;
}

#pragma optimize( "", off )
int main() {
    char moreStack[1000];
    for (int i = 0; i < sizeof(moreStack); ++i)
        moreStack[i] = i;
    return old_main();
}